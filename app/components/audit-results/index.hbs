<section
  local-class='results-region'
  role='region'
  aria-labelledby='results-heading'
  aria-busy={{@isLoading}}
  aria-atomic='true'
>
  <h3
    id='results-heading'
    tabindex='-1'
    {{did-insert this.captureHeading}}
    {{did-update this.onResultsChange @isLoading @results}}
  >
    {{#if @isLoading}}{{else if this.hasResults}}
    <div local-class='image-with-text'>
      <img
        src='/a11ycat-sad.png'
        alt=''
        role='presentation'
        local-class='a11ycat-image'
      />
      Audit complete. Found
      {{this.resultCount}}
      violations.
      </div>
    {{else if this.hasNoResults}}
      Audit complete, no violations found.
    {{else}}
      Audit Results
    {{/if}}
  </h3>

  {{#if @isLoading}}
    <LoadingScreen @message='Running audit‚Ä¶' />

  {{else if this.hasResults}}
    <p local-class='sr-only' aria-live='polite'>
      Audit complete. Found
      {{this.resultCount}}
      issues.
    </p>

    <ul local-class='results'>
      {{#each @results key='id' as |violation index|}}
        <li
          id='violation-{{violation.id}}'
          local-class='violation'
          data-impact='{{or violation.impact "unknown"}}'
        >
          <h3 local-class='violation-heading'>
            <span local-class='impact-badge'>{{or
                violation.impact
                'unknown'
              }}</span>
            {{violation.id}}
          </h3>

          <p local-class='desc'>{{violation.description}}</p>
          <p local-class='help'>{{violation.help}}</p>

          {{#if violation.nodes}}
            <ul local-class='violation-nodes'>
              {{#each violation.nodes key='@index' as |node nodeIndex|}}
                <li local-class='node'>
                  <div local-class='node-header'>
                    <span local-class='field-label'>Affected element</span>
                    <code local-class='selector'>{{get node 'target.0'}}</code>
                  </div>

                  <div
                    local-class='code-wrap'
                    role='group'
                    aria-label='HTML snippet'
                  >
                    <pre local-class='code-block'><code
                      >{{node.html}}</code></pre>
                  </div>
                </li>
              {{/each}}
            </ul>
          {{/if}}
        </li>
      {{/each}}
    </ul>

  {{else if this.hasNoResults}}
    <p local-class='sr-only' aria-live='polite'>
      Audit complete. No issues found.
    </p>
    <div local-class='image-with-text'>
      <img
        src='/a11ycat-happy.png'
        alt=''
        role='presentation'
        local-class='a11ycat-image'
      />
      <span>Purrrfect, no accessibility issues found</span>
    </div>

  {{else if (and @htmlInput (not @auditRun))}}
    <p local-class='no-results-yet'>
      Click ‚ÄúRun Audit‚Äù to check your HTML for accessibility issues üîç
    </p>
  {{/if}}
</section>